<section>
    <categories-menu *ngIf="isOpenedCategoriesModal" 
        [isOpened]="isOpenedCategoriesModal"
        [selectedCategory]="selectedCategory" 
        (close)="toggleCategoriesModal()"
        (selectCategoryInModal)="selectCategoryInModal($event)">
    </categories-menu>

    <div class="products-header">
        <div class="products-nav">
            <div>
                <a href="/">Home</a>
                <mat-icon>chevron_right</mat-icon>
                <a>{{selectedCategory}}</a>
            </div>
            <h2>{{selectedCategory}}</h2>
        </div>

        <div class="extra_info">
            <p>
                <span>{{producrsAmount}} items</span> in
                <span>{{selectedCategory}}</span>
            </p>

            <select id="filterCategories" name="filterCategories" [(ngModel)]="selectedSortOption"
                (change)="loadData()">
                <!-- <option value="average">Sort by average rating</option> -->
                <option value="all">All products</option>
                <option value="popular">Most popular first</option>
                <option value="cheapest">The cheapest first</option>
                <option value="expensive">The most expensive first</option>
            </select>

            <button class="categories-btn" (click)="toggleCategoriesModal()">
                <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="wrapper">
                        <path id="Vector"
                            d="M13.4568 16.8491L17.8053 16.8491C18.0279 16.8491 18.2415 16.7607 18.3989 16.6033C18.5563 16.4458 18.6448 16.2323 18.6448 16.0097C18.6448 15.787 18.5563 15.5735 18.3989 15.4161C18.2415 15.2586 18.0279 15.1702 17.8053 15.1702L13.4568 15.1702C13.2803 14.684 12.9585 14.2639 12.5349 13.9671C12.1114 13.6702 11.6067 13.511 11.0895 13.511C10.5723 13.511 10.0676 13.6702 9.64404 13.9671C9.22049 14.2639 8.89861 14.684 8.72215 15.1702L2.6947 15.1702C2.47206 15.1702 2.25854 15.2586 2.1011 15.4161C1.94367 15.5735 1.85523 15.787 1.85523 16.0097C1.85523 16.2323 1.94367 16.4458 2.1011 16.6033C2.25854 16.7607 2.47206 16.8491 2.6947 16.8491L8.72215 16.8491C8.89861 17.3353 9.22049 17.7554 9.64404 18.0523C10.0676 18.3491 10.5723 18.5084 11.0895 18.5084C11.6067 18.5084 12.1114 18.3491 12.5349 18.0523C12.9585 17.7554 13.2803 17.3353 13.4568 16.8491V16.8491ZM10.25 16.0097C10.25 15.8436 10.2992 15.6813 10.3915 15.5433C10.4837 15.4052 10.6148 15.2976 10.7682 15.2341C10.9216 15.1706 11.0904 15.1539 11.2533 15.1863C11.4161 15.2187 11.5657 15.2987 11.6831 15.4161C11.8005 15.5335 11.8804 15.6831 11.9128 15.8459C11.9452 16.0087 11.9286 16.1775 11.8651 16.3309C11.8015 16.4843 11.6939 16.6154 11.5559 16.7077C11.4178 16.7999 11.2555 16.8491 11.0895 16.8491C10.8668 16.8491 10.6533 16.7607 10.4959 16.6033C10.3384 16.4458 10.25 16.2323 10.25 16.0097ZM8.41994 10.9728L17.8053 10.9728C18.0279 10.9728 18.2415 10.8844 18.3989 10.7269C18.5563 10.5695 18.6448 10.356 18.6448 10.1333C18.6448 9.91068 18.5563 9.69716 18.3989 9.53973C18.2415 9.3823 18.0279 9.29385 17.8053 9.29385L8.41994 9.29385C8.24348 8.80767 7.9216 8.3876 7.49806 8.09075C7.07451 7.79389 6.56983 7.63464 6.05261 7.63464C5.5354 7.63464 5.03072 7.79389 4.60717 8.09075C4.18363 8.3876 3.86175 8.80766 3.68529 9.29385L2.6947 9.29385C2.47206 9.29385 2.25854 9.38229 2.1011 9.53973C1.94367 9.69716 1.85523 9.91068 1.85523 10.1333C1.85523 10.356 1.94367 10.5695 2.1011 10.7269C2.25854 10.8844 2.47206 10.9728 2.6947 10.9728L3.68529 10.9728C3.86175 11.459 4.18363 11.8791 4.60717 12.1759C5.03072 12.4728 5.5354 12.632 6.05261 12.632C6.56983 12.632 7.07451 12.4728 7.49806 12.1759C7.9216 11.8791 8.24348 11.459 8.41994 10.9728ZM5.21314 10.1333C5.21314 9.96729 5.26237 9.80499 5.35461 9.66694C5.44686 9.52889 5.57797 9.42129 5.73136 9.35775C5.88475 9.29421 6.05355 9.27759 6.21639 9.30998C6.37923 9.34237 6.52881 9.42232 6.64621 9.53973C6.76362 9.65713 6.84357 9.80671 6.87596 9.96955C6.90835 10.1324 6.89173 10.3012 6.82819 10.4546C6.76465 10.608 6.65705 10.7391 6.519 10.8313C6.38095 10.9236 6.21865 10.9728 6.05261 10.9728C5.82997 10.9728 5.61645 10.8844 5.45901 10.7269C5.30158 10.5695 5.21314 10.356 5.21314 10.1333ZM15.1358 5.09646L17.8053 5.09646C18.0279 5.09646 18.2415 5.00802 18.3989 4.85059C18.5563 4.69315 18.6448 4.47963 18.6448 4.25699C18.6448 4.03434 18.5563 3.82082 18.3989 3.66339C18.2415 3.50595 18.0279 3.41751 17.8053 3.41751L15.1358 3.41751C14.9593 2.93132 14.6374 2.51126 14.2139 2.2144C13.7903 1.91755 13.2857 1.7583 12.7684 1.7583C12.2512 1.7583 11.7465 1.91755 11.323 2.2144C10.8994 2.51126 10.5776 2.93132 10.4011 3.41751L2.6947 3.41751C2.47206 3.41751 2.25854 3.50595 2.1011 3.66339C1.94367 3.82082 1.85523 4.03434 1.85523 4.25699C1.85523 4.47963 1.94367 4.69315 2.1011 4.85059C2.25854 5.00802 2.47206 5.09646 2.6947 5.09646L10.4011 5.09646C10.5776 5.58265 10.8994 6.00271 11.323 6.29957C11.7465 6.59642 12.2512 6.75567 12.7684 6.75567C13.2857 6.75567 13.7903 6.59642 14.2139 6.29957C14.6374 6.00271 14.9593 5.58265 15.1358 5.09646V5.09646ZM11.929 4.25699C11.929 4.09095 11.9782 3.92865 12.0704 3.7906C12.1627 3.65255 12.2938 3.54495 12.4472 3.48141C12.6006 3.41787 12.7694 3.40125 12.9322 3.43364C13.095 3.46603 13.2446 3.54598 13.362 3.66339C13.4794 3.78079 13.5594 3.93037 13.5918 4.09321C13.6242 4.25605 13.6075 4.42485 13.544 4.57824C13.4805 4.73163 13.3729 4.86274 13.2348 4.95499C13.0968 5.04723 12.9345 5.09646 12.7684 5.09646C12.5458 5.09646 12.3323 5.00802 12.1748 4.85059C12.0174 4.69315 11.929 4.47963 11.929 4.25699Z"
                            fill="#1E1E28" />
                    </g>
                </svg>
            </button>
        </div>
    </div>
    <mat-drawer-container class="main-container">
        <mat-drawer mode="side" class="sider" opened>
            <p>General</p>
            <ul>
                <li (click)="selectCategoryAndSearchQuery('All Products', query)"
                    [ngStyle]="{'border': 'All Products' === selectedCategory ? '1px solid #0F67FE' : '1px solid #CCC'}">
                    All Products
                </li>
                <li *ngFor="let category of categories" (click)="selectCategoryAndSearchQuery(category, query)"
                    [ngStyle]="{'border': category === selectedCategory ? '1px solid #0F67FE' : '1px solid #CCC'}">
                    {{ category }}
                </li>
            </ul>
        </mat-drawer>


        <mat-drawer-content>
            <ul class="products-list">
                <li *ngFor="let item of products | paginate: { itemsPerPage: pageSize, currentPage: currentPage }">
                    <product-card [title]="item.title" [substance]="item.substance" [price]="item.price" [id]="item.id">
                    </product-card>
                </li>
            </ul>

            <pagination-controls class="my-pagination" (pageChange)="currentPage = $event" previousLabel=""
                nextLabel="">
            </pagination-controls>

        </mat-drawer-content>
    </mat-drawer-container>
</section>